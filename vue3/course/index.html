<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue3 使用文档 | 七天博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/favicon.ico">
    <meta name="description" content="">
    <meta name="keywords" content="vue,vue3">
    <meta name="author" content="七天">
    
    <link rel="preload" href="/blog/assets/css/0.styles.14da610f.css" as="style"><link rel="preload" href="/blog/assets/js/app.58c6e035.js" as="script"><link rel="preload" href="/blog/assets/js/7.ed085243.js" as="script"><link rel="preload" href="/blog/assets/js/2.24c2bd5b.js" as="script"><link rel="preload" href="/blog/assets/js/30.5af5a643.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.6bdf5d3d.js"><link rel="prefetch" href="/blog/assets/js/11.c18a9f69.js"><link rel="prefetch" href="/blog/assets/js/12.caac2d95.js"><link rel="prefetch" href="/blog/assets/js/13.aca5ec30.js"><link rel="prefetch" href="/blog/assets/js/14.6d306085.js"><link rel="prefetch" href="/blog/assets/js/15.f048736f.js"><link rel="prefetch" href="/blog/assets/js/16.c13cba98.js"><link rel="prefetch" href="/blog/assets/js/17.39cfb2c4.js"><link rel="prefetch" href="/blog/assets/js/18.9425d684.js"><link rel="prefetch" href="/blog/assets/js/19.f64b3ce3.js"><link rel="prefetch" href="/blog/assets/js/20.de40099c.js"><link rel="prefetch" href="/blog/assets/js/21.0fff9366.js"><link rel="prefetch" href="/blog/assets/js/22.604fe1ee.js"><link rel="prefetch" href="/blog/assets/js/23.356efa1a.js"><link rel="prefetch" href="/blog/assets/js/24.919f205b.js"><link rel="prefetch" href="/blog/assets/js/25.39802ff1.js"><link rel="prefetch" href="/blog/assets/js/26.93092dc0.js"><link rel="prefetch" href="/blog/assets/js/27.aaf0e2b2.js"><link rel="prefetch" href="/blog/assets/js/28.75361c95.js"><link rel="prefetch" href="/blog/assets/js/29.112e081f.js"><link rel="prefetch" href="/blog/assets/js/3.c2a0ba11.js"><link rel="prefetch" href="/blog/assets/js/31.c7783000.js"><link rel="prefetch" href="/blog/assets/js/32.18239714.js"><link rel="prefetch" href="/blog/assets/js/33.045a15be.js"><link rel="prefetch" href="/blog/assets/js/34.ff8403d2.js"><link rel="prefetch" href="/blog/assets/js/35.1946489a.js"><link rel="prefetch" href="/blog/assets/js/4.b05b8f69.js"><link rel="prefetch" href="/blog/assets/js/5.b42ed5be.js"><link rel="prefetch" href="/blog/assets/js/6.fc1ac2fc.js"><link rel="prefetch" href="/blog/assets/js/8.bf280482.js"><link rel="prefetch" href="/blog/assets/js/9.c3fcb4a0.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.14da610f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/assets/img/avatar.jpg" alt="七天博客" class="logo"> <span class="site-name can-hide">七天博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/vue3/course/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  vue3
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="project problem" class="dropdown-title"><span class="title">project problem</span> <span class="arrow down"></span></button> <button type="button" aria-label="project problem" class="mobile-dropdown-title"><span class="title">project problem</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/js/" class="nav-link">
  js数据处理
</a></li><li class="dropdown-item"><!----> <a href="/blog/project/" class="nav-link">
  项目积累
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具语法" class="dropdown-title"><span class="title">工具语法</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具语法" class="mobile-dropdown-title"><span class="title">工具语法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Markdown/" class="nav-link">
  Markdown
</a></li><li class="dropdown-item"><!----> <a href="/blog/typora/" class="nav-link">
  typora
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="相关网页" class="dropdown-title"><span class="title">相关网页</span> <span class="arrow down"></span></button> <button type="button" aria-label="相关网页" class="mobile-dropdown-title"><span class="title">相关网页</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Github
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/Iris-mile/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  仓库地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://iris-mile.github.io/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          博客搭建
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.vuepress.cn/config/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuepress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/vue3/course/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  vue3
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="project problem" class="dropdown-title"><span class="title">project problem</span> <span class="arrow down"></span></button> <button type="button" aria-label="project problem" class="mobile-dropdown-title"><span class="title">project problem</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/js/" class="nav-link">
  js数据处理
</a></li><li class="dropdown-item"><!----> <a href="/blog/project/" class="nav-link">
  项目积累
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具语法" class="dropdown-title"><span class="title">工具语法</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具语法" class="mobile-dropdown-title"><span class="title">工具语法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Markdown/" class="nav-link">
  Markdown
</a></li><li class="dropdown-item"><!----> <a href="/blog/typora/" class="nav-link">
  typora
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="相关网页" class="dropdown-title"><span class="title">相关网页</span> <span class="arrow down"></span></button> <button type="button" aria-label="相关网页" class="mobile-dropdown-title"><span class="title">相关网页</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Github
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/Iris-mile/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  仓库地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://iris-mile.github.io/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客地址
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          博客搭建
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.vuepress.cn/config/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuepress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>vue3课程知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue3/course/" aria-current="page" class="active sidebar-link">Vue3 使用文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue3/course/#vue3-特性" class="sidebar-link">vue3 特性</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#vue3-router配置" class="sidebar-link">vue3 router配置</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#composition-api-vs-option-api" class="sidebar-link">Composition API VS Option API</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_1-setup-函数-【重点】" class="sidebar-link">1 setup 函数 【重点】</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_2-ref-数据响应-【重点】" class="sidebar-link">2 ref 数据响应 【重点】</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_3-reactive-数据响应-【重点】" class="sidebar-link">3 reactive 数据响应 【重点】</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_4-torefs-【重点】" class="sidebar-link">4 toRefs 【重点】</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_5-toref" class="sidebar-link">5 toRef</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_6-计算属性" class="sidebar-link">6 计算属性</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_7-侦听器-watch" class="sidebar-link">7 侦听器 watch</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_8-生命周期" class="sidebar-link">8  生命周期</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_9-defineprops-和-defineemits-父子传参" class="sidebar-link">9 defineProps 和 defineEmits 父子传参</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_10-defineexpose-子组件暴露数据方法" class="sidebar-link">10  defineExpose 子组件暴露数据方法</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_11-自定义hooks函数" class="sidebar-link">11 自定义hooks函数</a></li><li class="sidebar-sub-header"><a href="/blog/vue3/course/#_12-其他新组件" class="sidebar-link">12 其他新组件</a></li></ul></li><li><a href="/blog/vue3/course/vite.html" class="sidebar-link">Vite 构建项目</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue3课程笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue3/my/" class="sidebar-link">Vue3 学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue3项目累计</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue3/project/" class="sidebar-link">svg使用和组件封装</a></li><li><a href="/blog/vue3/project/item1.html" class="sidebar-link">项目问题</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="vue3-特性"><a href="#vue3-特性" class="header-anchor">#</a> vue3 特性</h2> <ul><li><p>Vue.js 3.0 &quot;One Piece&quot;  2019年发布</p></li> <li><p>新的响应式原理 ref reactive</p></li> <li><p><strong>diff 算法优化</strong></p> <ul><li>Vue 2 中的虚拟 Dom 是全量比较。Vue 3 新增静态标记（PatchFlag）。在与数据变化后，与上次虚拟 DOM 节点比较时，只比较带有 PatchFlag 标记的节点。并且可以从 flag 信息中得知具体需要比较的内容。</li> <li><strong>重写虚拟 DOM 的实现和 Tree-Shaking</strong></li></ul></li> <li><p><strong>组合式 api（composition api） setup 函数</strong> 【99%代码都在里面写】</p></li> <li><p>新的计算属性 computed 新的侦听器 watch</p></li> <li><p><strong>hooks 语法</strong> （当然是抄 react 的啦）</p></li> <li><p>生命周期变化</p></li> <li><p>vue2 v-for 优先级高于 v-if <strong>vue3 v-if 优先级高于 v-for</strong></p></li> <li><p>v-model的本质变化</p> <ul><li>prop：value -&gt; modelValue；</li> <li>event：input -&gt; update:modelValue；</li></ul></li> <li><p>.sync修改符已移除, 由v-model代替</p></li> <li><p>其他组件和 api 变化</p></li></ul> <h2 id="vue3-router配置"><a href="#vue3-router配置" class="header-anchor">#</a> vue3 router配置</h2> <h3 id="路由使用三步骤"><a href="#路由使用三步骤" class="header-anchor">#</a> 路由使用三步骤</h3> <ul><li>建 【views 文件夹下面简历里面级别组件    如果是后台框架就在src文件夹下 建立layout文件夹】</li> <li>配 【router/index.js 里面配置页面级别组件和路由地址的一一对应关系】</li> <li>测 【输入地址测试 要给出口】
<ul><li>路由视图组件</li> <li>路由导航组件</li></ul></li></ul> <h3 id="router-index-js"><a href="#router-index-js" class="header-anchor">#</a> router/index.js</h3> <div class="language-js extra-class"><pre class="language-js"><code>#createRouter 创建路由工厂函数
#createWebHashHistory 选用hash模式
#createWebHistory 或者选用历史模式 vue3 历史模式刷新不报错
<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHashHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue-router&quot;</span><span class="token punctuation">;</span>

#静态引入路由组件
<span class="token keyword">import</span> 静态组件 <span class="token keyword">from</span> <span class="token string">'组件地址'</span>

#配置路由地址和页面级别组件的一一对应关系
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
	<span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'/路由地址'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'组件地址'</span><span class="token punctuation">)</span>  #懒加载路由组件
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
	<span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">'/路由地址'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span>静态组件
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    
  
   # <span class="token number">404</span> 修改了 <span class="token operator">/</span><span class="token operator">:</span><span class="token function">pathMatch</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">)</span>匹配所有路由
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/:pathMatch(.*)'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">'/404'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/404'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/not-found/index.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hidden</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

#创建路由
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> #hash模式
    routes #导入路由配置
<span class="token punctuation">}</span><span class="token punctuation">)</span>

#导出配置好的路由
<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre></div><h3 id="main-js-导入"><a href="#main-js-导入" class="header-anchor">#</a> main.js 导入</h3> <div class="language-js extra-class"><pre class="language-js"><code>#导入 createApp 工厂函数
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
#导入App<span class="token punctuation">.</span>vue 
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token comment">//导入路由</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span>

<span class="token comment">//拆解工厂函数创建对象</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token comment">//使用路由</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>

<span class="token comment">//挂载在#app的div上</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="composition-api-vs-option-api"><a href="#composition-api-vs-option-api" class="header-anchor">#</a> Composition API VS Option API</h2> <ul><li>配置项 Option API 数据,方法,计算属性等等 写在规定的配置项里面</li></ul> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f84e4e2c02424d9a99862ade0a2e4114~tplv-k3u1fbpfcp-watermark.image" alt=""></p> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ac7e20d1784887a826f6360768a368~tplv-k3u1fbpfcp-watermark.image" alt=""></p> <ul><li>Composition API  组合式API</li> <li>我们可以更加优雅的组织我们的代码，函数。让相关功能的代码更加有序的组织在一起</li></ul> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc0be8211fc54b6c941c036791ba4efe~tplv-k3u1fbpfcp-watermark.image" alt=""></p> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6cc55165c0e34069a75fe36f8712eb80~tplv-k3u1fbpfcp-watermark.image" alt=""></p> <ul><li>配置项API vs 组合式API</li></ul> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2c421e5392504ecc94c222057dba338a~tplv-k3u1fbpfcp-watermark.image" alt=""></p> <h2 id="_1-setup-函数-【重点】"><a href="#_1-setup-函数-【重点】" class="header-anchor">#</a> 1 setup 函数 【重点】</h2> <ul><li>新的 option, 所有的组合 API 函数都在此使用, 只在初始化时执行一次</li> <li>函数如果返回对象, 对象中的属性或方法, 模板中可以直接使用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>在 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">setup</span><span class="token template-punctuation string">`</span></span> 中你应该避免使用 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">this</span><span class="token template-punctuation string">`</span></span>，因为它不会找到组件实例。<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">setup</span><span class="token template-punctuation string">`</span></span> 的调用发生在 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">data</span><span class="token template-punctuation string">`</span></span> property、<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">computed</span><span class="token template-punctuation string">`</span></span> property 或 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">methods</span><span class="token template-punctuation string">`</span></span> 被解析之前，所以它们无法在 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">setup</span><span class="token template-punctuation string">`</span></span> <span class="token function">中被获取，这也是为了避免setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>和其他选项式<span class="token constant">API</span>混淆。
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">'sayHi'</span><span class="token operator">&gt;</span>点击我<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token comment">//基本用法</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        #setup 函数里面执行的代码相当于 created生命周期

        <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token string">'小樱'</span>
        <span class="token keyword">const</span> <span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">'hi'</span>
        <span class="token punctuation">}</span>
        #<span class="token keyword">return</span>的属性和方法 可以在模板里面直接用
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            msg<span class="token punctuation">,</span>
            sayHi
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>


#高级用法 推荐！！！
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">'sayHi'</span><span class="token operator">&gt;</span>点击我<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

#setup 表示script里面的代码全部都写在setup函数内部  而vue3代码全部可以在里面跑完
<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
#不需要<span class="token keyword">return</span> 定义好直接可以在模板里面使用 非常的nice！
<span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token string">'小樱'</span>
<span class="token keyword">const</span> <span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'hi'</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_2-ref-数据响应-【重点】"><a href="#_2-ref-数据响应-【重点】" class="header-anchor">#</a> 2 ref 数据响应 【重点】</h2> <p>作用： <strong>基本数据类型</strong>的数据响应定义 或者<strong>dom 连接</strong></p> <ul><li>基本数据类型绑定
<ul><li>创建 RefImpl 响应式 Proxy 对象 ref 内部: 通过给 value 属性添加 getter/setter 来实现对数据的劫持</li> <li>定义数据之后，模板里面直接使用值</li> <li>修改数据 用.value 属性修改[重要!!!]</li></ul></li> <li>响应式状态需要明确使用<a href="https://v3.cn.vuejs.org/api/basic-reactivity.html" target="_blank" rel="noopener noreferrer">响应式 APIs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 来创建。和从 <code>setup()</code> 函数中返回值一样，ref 值在模板中使用的时候会自动解包</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>变量名<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">'change'</span><span class="token operator">&gt;</span>点击我<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
#引入ref 函数
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

#创建响应式数据
<span class="token keyword">const</span> 变量名 <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>初始值<span class="token punctuation">)</span>

#修改响应式数据   注意别修改原数据
<span class="token keyword">const</span> <span class="token function-variable function">change</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  变量名<span class="token punctuation">.</span>value <span class="token operator">=</span> 修改之后的值
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><ul><li>dom 绑定</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>标签 ref<span class="token operator">=</span><span class="token string">'变量名'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>标签<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
#引入ref 函数
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

#创建dom 绑定必须变量名 相同
<span class="token keyword">const</span> 变量名 <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_3-reactive-数据响应-【重点】"><a href="#_3-reactive-数据响应-【重点】" class="header-anchor">#</a> 3 reactive 数据响应 【重点】</h2> <p>作用： **引用类型的数据响应定义 **</p> <ul><li>作用: 定义多个数据的响应式</li> <li>const proxy = reactive(obj): 接收一个普通对象然后返回该普通对象的响应式代理器对象</li> <li>响应式转换是“深层的”：会影响对象内部所有嵌套的属性</li> <li>内部基于 ES6 的 Proxy 实现，通过代理对象操作源对象内部数据都是响应式的</li></ul> <ul><li>语法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>state<span class="token punctuation">.</span>属性<span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
#引入reactive 函数
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

#创建响应式数据
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    属性<span class="token number">1</span><span class="token operator">:</span>值<span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>state<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>state<span class="token punctuation">.</span>k1<span class="token punctuation">.</span>k2<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">'change'</span><span class="token operator">&gt;</span>点击我<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
#引入reactive 函数
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

#创建响应式数据
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'小樱'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">k1</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">k2</span><span class="token operator">:</span><span class="token number">666</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

#修改响应式数据   注意别修改原数据
<span class="token keyword">const</span> <span class="token function-variable function">change</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'小狼'</span>
    state<span class="token punctuation">.</span>k1<span class="token punctuation">.</span>k2 <span class="token operator">=</span> <span class="token number">999</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_4-torefs-【重点】"><a href="#_4-torefs-【重点】" class="header-anchor">#</a> 4 toRefs 【重点】</h2> <p>作用：将响应式对象转换为普通对象，其中结果对象的每个 property 都是指向原始对象相应 property 的 <a href="https://v3.cn.vuejs.org/api/refs-api.html#ref" target="_blank" rel="noopener noreferrer"><code>ref</code> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>当从组合式函数返回响应式对象时， <code>toRefs</code> 非常有用，这样消费组件就可以在不丢失响应性的情况下对返回的对象进行解构/展开：</p> <ul><li>语法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
#引入reactive toRefs 函数
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

#创建响应式数据
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    属性<span class="token number">1</span><span class="token operator">:</span>值<span class="token number">1</span><span class="token punctuation">,</span>
    属性<span class="token number">2</span><span class="token operator">:</span>值<span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

#数据解构出来<span class="token punctuation">,</span>创建属性的ref<span class="token punctuation">,</span>都通过value来获取值
<span class="token keyword">const</span> <span class="token punctuation">{</span> 属性<span class="token number">1</span><span class="token punctuation">,</span> 属性<span class="token number">2</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><ul><li>示例</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">'change'</span><span class="token operator">&gt;</span>点击我<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
#引入reactive toRefs 函数
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

#创建响应式数据
  <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'小樱'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'唱歌'</span><span class="token punctuation">,</span> <span class="token string">'跳舞'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hands</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">100</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

#数据解构出来 创建属性的ref 都通过value来获取值

#响应的ref数据改变会影响原代理对象
<span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> hobs<span class="token punctuation">,</span> hands <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">change</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'小狼'</span>
    age<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">12</span>
    hobs<span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'洗澡澡'</span>
    hands<span class="token punctuation">.</span>value<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token number">200</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_5-toref"><a href="#_5-toref" class="header-anchor">#</a> 5 toRef</h2> <p>可以用来为源响应式对象上的某个 property 新创建一个 <a href="https://v3.cn.vuejs.org/api/refs-api.html#ref" target="_blank" rel="noopener noreferrer"><code>ref</code> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。然后，ref 可以被传递，它会保持对其源 property 的响应式连接。</p> <ul><li>语法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    属性<span class="token number">1</span><span class="token operator">:</span>值<span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> ref变量 <span class="token operator">=</span> <span class="token function">toRef</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token string">'属性1'</span><span class="token punctuation">)</span>

</code></pre></div><ul><li>示例</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> fooRef <span class="token operator">=</span> <span class="token function">toRef</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">)</span>

fooRef<span class="token punctuation">.</span>value<span class="token operator">++</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>foo<span class="token punctuation">)</span> <span class="token comment">// 2</span>

state<span class="token punctuation">.</span>foo<span class="token operator">++</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fooRef<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// 3</span>
</code></pre></div><h2 id="_6-计算属性"><a href="#_6-计算属性" class="header-anchor">#</a> 6 计算属性</h2> <ul><li>computed函数:
<ul><li>与computed配置功能一致</li> <li>只有getter</li> <li>有getter和setter</li></ul></li></ul> <ul><li>语法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>#简单用法 只有getter形式
<span class="token keyword">const</span> 计算属性变量 <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> 处理好的数据
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

#有getter 有 setter形式
<span class="token keyword">const</span> 计算属性变量 <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   	<span class="token keyword">return</span> xx
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	  
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>示例</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>#getter
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>计算属性 computed<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> msg <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>取反数据<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span> reverseMsg <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;msg = '我是一个新数据'&quot;</span><span class="token operator">&gt;</span>修改原数据<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'我是一个数据'</span><span class="token punctuation">)</span>

<span class="token comment">//写法1 只有getter 得到计算属性的结果数据</span>
<span class="token keyword">const</span> reverseMsg <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token operator">...</span>msg<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>


#getter <span class="token operator">&amp;</span> setter
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>计算属性 computed<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> msg <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>取反数据<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span> reverseMsg <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;msg = '我是一个新数据'&quot;</span><span class="token operator">&gt;</span>修改原数据<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;changeRes&quot;</span><span class="token operator">&gt;</span>修改计算属性<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'我是一个数据'</span><span class="token punctuation">)</span>

#写法<span class="token number">2</span> getter函数 <span class="token operator">&amp;</span> setter函数  可以修改计算属性的值必须用到setter
<span class="token keyword">const</span> reverseMsg <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">//取值 触发 getter函数</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>msg<span class="token punctuation">.</span>value<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    #改值触发 setter函数
    <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        msg<span class="token punctuation">.</span>value <span class="token operator">=</span> value
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">changeRes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    #修改计算属性 触发计算属性的setter函数
    reverseMsg<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'我是计算属性的setter'</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_7-侦听器-watch"><a href="#_7-侦听器-watch" class="header-anchor">#</a> 7 侦听器 watch</h2> <ul><li><p>watch函数</p> <ul><li><p>与watch配置功能一致</p></li> <li><p>监视指定的一个或多个响应式数据, 一旦数据变化, 就自动执行监视回调</p></li> <li><p>默认初始时不执行回调, 但可以通过配置immediate为true, 来指定初始时立即执行第一次</p></li> <li><p>通过配置deep为true, 来指定深度监视</p></li></ul></li> <li><p>watchEffect函数 【理解】</p> <ul><li>不用直接指定要监视的数据, 回调函数中使用的哪些响应式数据就监视哪些响应式数据</li> <li>默认初始时就会执行第一次, 从而可以收集需要监视的数据</li> <li>监视数据发生变化时回调</li></ul></li> <li><p>语法</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>#简单用法 
<span class="token function">watch</span><span class="token punctuation">(</span>ref 或者reactive 数据<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newV<span class="token punctuation">,</span>oldV</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
     <span class="token comment">//观察数据变化执行 里面代码</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token literal-property property">immediate</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//立即执行</span>
    <span class="token literal-property property">deep</span><span class="token operator">:</span><span class="token boolean">true</span> <span class="token comment">//深度监听</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
 
#观察多个数据变化
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>state<span class="token punctuation">.</span>属性<span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>state<span class="token punctuation">.</span>属性<span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        
<span class="token punctuation">}</span><span class="token punctuation">)</span>
 
#watchEffect 会立即执行里面代码  监视所有回调中使用的数据
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
     
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>示例</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>watch <span class="token operator">&amp;</span> watchEffect 侦听器<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>watch监听基本类型<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;msg&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> msg <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>监听引用类型<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> state <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;state.fa.fa = '奶奶'; state.age = 13&quot;</span><span class="token operator">&gt;</span>深度改变state<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> watchEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token comment">//基本类型</span>
<span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'我是初始值'</span><span class="token punctuation">)</span>

<span class="token comment">//引用类型</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'小樱'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token literal-property property">fa</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">fa</span><span class="token operator">:</span> <span class="token string">'爷爷'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//监听基本类型</span>
<span class="token function">watch</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newV<span class="token punctuation">,</span> oldV</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//观察数据执行你想执行的一切代码</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'oldV :&gt;&gt; '</span><span class="token punctuation">,</span> oldV<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'newV :&gt;&gt; '</span><span class="token punctuation">,</span> newV<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//立即执行</span>
    <span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token comment">//深度监听</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//监听引用类型  可以监听深度改变</span>
<span class="token function">watch</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newV</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'newV :&gt;&gt; '</span><span class="token punctuation">,</span> newV<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//监听多个类型 基本类型直接写,引用类型用回调函数形式监听属性变化</span>
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>msg<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>age<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newV</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'多个监听 :&gt;&gt; '</span><span class="token punctuation">,</span> newV<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//只要回调函数里面有数据被引用 就会执行回调函数代码 --[注重过程]</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'观察 :&gt;&gt; '</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_8-生命周期"><a href="#_8-生命周期" class="header-anchor">#</a> 8  生命周期</h2> <p>因为 <code>setup</code> 是围绕 <code>beforeCreate</code> 和 <code>created</code> 生命周期钩子运行的，所以不需要显式地定义它们。换句话说，在这些钩子中编写的任何代码都应该直接在 <code>setup</code> 函数中编写。</p> <p>下表包含如何在 <a href="https://v3.cn.vuejs.org/guide/composition-api-setup.html" target="_blank" rel="noopener noreferrer">setup ()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 内部调用生命周期钩子：</p> <table><thead><tr><th>选项式 API</th> <th style="text-align:left;">Hook inside <code>setup</code></th></tr></thead> <tbody><tr><td><code>beforeCreate</code></td> <td style="text-align:left;">Not needed*    不需要</td></tr> <tr><td><code>created</code></td> <td style="text-align:left;">Not needed*    不需要</td></tr> <tr><td><code>beforeMount</code></td> <td style="text-align:left;"><code>onBeforeMount</code> 挂载之前</td></tr> <tr><td><code>mounted</code></td> <td style="text-align:left;"><code>onMounted</code>    页面加载完成时执行    ###</td></tr> <tr><td><code>beforeUpdate</code></td> <td style="text-align:left;"><code>onBeforeUpdate</code></td></tr> <tr><td><code>updated</code></td> <td style="text-align:left;"><code>onUpdated</code></td></tr> <tr><td><code>beforeUnmount</code></td> <td style="text-align:left;"><code>onBeforeUnmount</code></td></tr> <tr><td><code>unmounted</code></td> <td style="text-align:left;"><code>onUnmounted</code>  页面销毁时执行   ###</td></tr> <tr><td><code>errorCaptured</code></td> <td style="text-align:left;"><code>onErrorCaptured</code></td></tr> <tr><td><code>renderTracked</code></td> <td style="text-align:left;"><code>onRenderTracked</code></td></tr> <tr><td><code>renderTriggered</code></td> <td style="text-align:left;"><code>onRenderTriggered</code></td></tr> <tr><td><code>activated</code></td> <td style="text-align:left;"><code>onActivated</code></td></tr> <tr><td><code>deactivated</code></td> <td style="text-align:left;"><code>onDeactivated</code></td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script setup <span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> onActivated<span class="token punctuation">,</span> onUnmounted<span class="token punctuation">,</span> onUpdated<span class="token punctuation">,</span> onDeactivated <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

 <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;组件挂载&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;组件卸载&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token function">onUpdated</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;组件更新&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token function">onActivated</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;keepAlive 组件 激活&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>

 <span class="token function">onDeactivated</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;keepAlive 组件 非激活&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_9-defineprops-和-defineemits-父子传参"><a href="#_9-defineprops-和-defineemits-父子传参" class="header-anchor">#</a> 9 defineProps 和 defineEmits 父子传参</h2> <p><strong><code>注意：defineProps</code> 和 <code>defineEmits</code> 都是只在 <code>&lt;script setup&gt;</code> 中才能使用的编译器宏</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>为了声明 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">props</span><span class="token template-punctuation string">`</span></span> 和 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">emits</span><span class="token template-punctuation string">`</span></span> 选项且具备完整的类型推断，可以使用 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineProps</span><span class="token template-punctuation string">`</span></span> 和 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineEmits</span><span class="token template-punctuation string">`</span></span> <span class="token constant">API</span>，它们在 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;script setup&gt;</span><span class="token template-punctuation string">`</span></span> 中都是自动可用的：

<span class="token operator">-</span> <span class="token operator">**</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineProps</span><span class="token template-punctuation string">`</span></span> 和 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineEmits</span><span class="token template-punctuation string">`</span></span> 都是只在 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;script setup&gt;</span><span class="token template-punctuation string">`</span></span> 中才能使用的<span class="token operator">**</span><span class="token operator">**</span>编译器宏<span class="token operator">**</span>。他们不需要导入，且会在处理 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;script setup&gt;</span><span class="token template-punctuation string">`</span></span> 的时候被编译处理掉。
<span class="token operator">-</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineProps</span><span class="token template-punctuation string">`</span></span> 接收与 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">props</span><span class="token template-punctuation string">`</span></span> 选项相同的值，<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineEmits</span><span class="token template-punctuation string">`</span></span> 也接收 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">emits</span><span class="token template-punctuation string">`</span></span> 选项相同的值。
<span class="token operator">-</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineProps</span><span class="token template-punctuation string">`</span></span> 和 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineEmits</span><span class="token template-punctuation string">`</span></span> 在选项传入后，会提供恰当的类型推断。
<span class="token operator">-</span> 传入到 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineProps</span><span class="token template-punctuation string">`</span></span> 和 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">defineEmits</span><span class="token template-punctuation string">`</span></span> 的选项会从 setup 中提升到模块的范围。因此，传入的选项不能引用在 setup 范围中声明的局部变量。这样做会引起编译错误。但是，它<span class="token operator">*</span>可以<span class="token operator">*</span>引用导入的绑定，因为它们也在模块范围内。
</code></pre></div><h3 id="父传子"><a href="#父传子" class="header-anchor">#</a> 父传子</h3> <div class="language-js extra-class"><pre class="language-js"><code>#父组件
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>子组件 自定义属性<span class="token number">1</span><span class="token operator">=</span><span class="token string">'静态'</span> <span class="token operator">:</span>自定义属性<span class="token number">2</span><span class="token operator">=</span><span class="token string">'动态值'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>子组件<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

#子组件
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token punctuation">{</span><span class="token punctuation">{</span>自定义属性<span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token punctuation">{</span><span class="token punctuation">{</span>自定义属性<span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
  #通过defineProps 接受的数据都在左侧自定义变量 props上<span class="token punctuation">[</span>props变量是响应式的<span class="token punctuation">]</span>
  #props接收的数据可以直接渲染
  <span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        自定义属性<span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">{</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> 类型<span class="token punctuation">,</span>
          <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 默认值
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        自定义属性<span class="token number">2</span><span class="token operator">:</span><span class="token punctuation">{</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> 类型<span class="token punctuation">,</span>
          <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 默认值
        <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h3 id="子传父"><a href="#子传父" class="header-anchor">#</a> 子传父</h3> <div class="language-js extra-class"><pre class="language-js"><code>#子组件
<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>

#定义子组件的自定义事件 <span class="token operator">--</span> 注册自定义事件
<span class="token keyword">const</span> emits <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'自定义事件1'</span><span class="token punctuation">,</span><span class="token string">'自定义事件2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

#触发子传父事件
<span class="token function">emits</span><span class="token punctuation">(</span><span class="token string">'自定义事件1'</span><span class="token punctuation">,</span> 数据<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

#父组件
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>子组件 @自定义事件<span class="token number">1</span><span class="token operator">=</span><span class="token string">&quot;处理函数&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>子组件<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>

#子组件 触发自定义事件<span class="token number">1</span> 父组件的处理函数 收到子传父的数据
<span class="token keyword">const</span> <span class="token function-variable function">处理函数</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_10-defineexpose-子组件暴露数据方法"><a href="#_10-defineexpose-子组件暴露数据方法" class="header-anchor">#</a> 10  defineExpose 子组件暴露数据方法</h2> <p>使用 <code>&lt;script setup&gt;</code> 的组件是<strong>默认关闭</strong>的，也即通过模板 ref 或者 <code>$parent</code> 链获取到的组件的公开实例，不会暴露任何在 <code>&lt;script setup&gt;</code> 中声明的绑定。</p> <p>为了在 <code>&lt;script setup&gt;</code> 组件中明确要暴露出去的属性，使用 <code>defineExpose</code> 编译器宏：</p> <ul><li>语法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>#子组件
<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>

#子组件暴露
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  属性<span class="token number">1</span><span class="token operator">:</span>值<span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token function">方法1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

#父组件
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>子组件 ref<span class="token operator">=</span><span class="token string">'子组件ref'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>子组件<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> 子组件ref <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
#注意 在生命周期onMounted 才能接受子组件暴露的数据和方法
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    子组件ref<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">方法1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    子组件ref<span class="token punctuation">.</span>value<span class="token punctuation">.</span>属性<span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_11-自定义hooks函数"><a href="#_11-自定义hooks函数" class="header-anchor">#</a> 11 自定义hooks函数</h2> <ul><li>使用Vue3的组合API封装的可复用的功能函数</li> <li>用来取代vue2 mixin 目的也是抽离公共js逻辑</li> <li>命名 userXxx开头的函数 一般会把一个功能封装在一个js中</li></ul> <h3 id="例如-封装一个table宽度动态变化功能的hooks函数"><a href="#例如-封装一个table宽度动态变化功能的hooks函数" class="header-anchor">#</a> 例如 封装一个table宽度动态变化功能的hooks函数</h3> <ul><li>hooks/useTableWidth.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/* table 宽度动态变化 */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> onUnmounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">/* 表单宽度设置 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">useTableWidth</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//dom</span>
  <span class="token keyword">const</span> tableRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> w <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>

  <span class="token comment">//计算宽度</span>
  <span class="token keyword">const</span> <span class="token function-variable function">calcTableWidth</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这个不能自动修改 有点怪</span>
    <span class="token comment">// table.value.style.width = document.body.clientWidth - 280 + 'px'</span>
    w<span class="token punctuation">.</span>value <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth <span class="token operator">-</span> <span class="token number">280</span> <span class="token operator">+</span> <span class="token string">'px'</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//挂载后</span>
  <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//初始化计算一次</span>
    <span class="token function">calcTableWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//窗口宽度变化计算一次</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> calcTableWidth<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">//销毁后</span>
  <span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> calcTableWidth<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    tableRef<span class="token punctuation">,</span>
    w<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useTableWidth
</code></pre></div><ul><li>使用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 表格 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>table ref<span class="token operator">=</span><span class="token string">&quot;tableRef&quot;</span>  <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">&quot;{ width: w }&quot;</span> <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
    
<span class="token keyword">import</span> useTableWidth <span class="token keyword">from</span> <span class="token string">'@/hooks/useTableWidth'</span><span class="token punctuation">;</span>
<span class="token comment">//计算table宽度</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> tableRef<span class="token punctuation">,</span> w <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useTableWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

</code></pre></div><h2 id="_12-其他新组件"><a href="#_12-其他新组件" class="header-anchor">#</a> 12 其他新组件</h2> <h3 id="fragment-片断"><a href="#fragment-片断" class="header-anchor">#</a> Fragment(片断)</h3> <ul><li>在Vue2中: 组件必须有一个根标签</li> <li>在Vue3中: 组件可以没有根标签, 内部会将多个标签包含在一个Fragment虚拟元素中</li> <li>好处: 减少标签层级, 减小内存占用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>#其实 两个div被包在Fragment 虚拟元素中 感觉没有根元素
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre></div><h3 id="teleport-传送门"><a href="#teleport-传送门" class="header-anchor">#</a> Teleport(传送门)</h3> <ul><li>Teleport 提供了一种干净的方法, 让组件的html在父组件界面外的特定标签
<ul><li>例如：可以把一个组件里面的弹窗popUp 直接插进body标签里面</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>#相当于 body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>弹窗<span class="token punctuation">)</span>
<span class="token operator">&lt;</span>teleport to<span class="token operator">=</span><span class="token string">&quot;body&quot;</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pop&quot;</span><span class="token operator">&gt;</span>
      弹窗
   <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>teleport<span class="token operator">&gt;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">2022-09-29 16:48</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/vue3/course/vite.html">
        Vite 构建项目
      </a>
      →
    </span></p></div>  <!----></main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.58c6e035.js" defer></script><script src="/blog/assets/js/7.ed085243.js" defer></script><script src="/blog/assets/js/2.24c2bd5b.js" defer></script><script src="/blog/assets/js/30.5af5a643.js" defer></script>
  </body>
</html>
